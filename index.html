<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
    
  RookieNeo
  
  </title>
 <meta name="description" content="å­¦è€Œä¸æ€åˆ™ç½”,æ€è€Œä¸å­¦åˆ™æ®†">
 <link href="atom.xml" rel="alternate" title="RookieNeo" type="application/atom+xml">
    <link rel="stylesheet" href="asset/css/foundation.min.css" />
    <link rel="stylesheet" href="asset/css/docs.css" />

    <script src="asset/js/vendor/modernizr.js"></script>
    <script src="asset/js/vendor/jquery.js"></script>
    <script src="asset/highlightjs/highlight.pack.js"></script>
    <link href="asset/highlightjs/styles/github.css" media="screen, projection" rel="stylesheet" type="text/css">
    <script>hljs.initHighlightingOnLoad();</script>
    
  </head>
  <body class="antialiased hide-extras">
    
    <div class="marketing off-canvas-wrap" data-offcanvas>
      <div class="inner-wrap">


<nav class="top-bar docs-bar hide-for-small" data-topbar>

<div id="header">
    <h1><a href="index.html">RookieNeo</a></h1>
</div>

</nav>
        <nav class="tab-bar show-for-small">
  <a href="javascript:void(0)" class="left-off-canvas-toggle menu-icon">
    <span> &nbsp; RookieNeo</span>
  </a>
</nav>

<aside class="left-off-canvas-menu">
      <ul class="off-canvas-list">
      <li><a href="index.html">Home</a></li>
      
        <li class="divider"></li>
        <li><label>Swift</label></li>

          
            <li><a title="æ²™æ¼åŠ¨ç”»" href="15367255656449.html">æ²™æ¼åŠ¨ç”»</a></li>
          
            <li><a title="å…³äºHTTPSçš„æ¢ç©¶" href="15221395300202.html">å…³äºHTTPSçš„æ¢ç©¶</a></li>
          
            <li><a title="çµæ´»æ‰©å±•çš„ä¸‹æ‹‰åˆ·æ–°æ§ä»¶çš„å°è£…" href="15113233292599.html">çµæ´»æ‰©å±•çš„ä¸‹æ‹‰åˆ·æ–°æ§ä»¶çš„å°è£…</a></li>
          
            <li><a title="å¯¹Swiftå†™æ—¶å¤åˆ¶æŠ€æœ¯çš„ç†è§£" href="15034498083541.html">å¯¹Swiftå†™æ—¶å¤åˆ¶æŠ€æœ¯çš„ç†è§£</a></li>
          
            <li><a title="ä»åˆ‡åœ†è§’å¼•å‘çš„å¯¹iOSåŠ¨ç”»æ¡†æ¶çš„æ¢ç©¶" href="15026719129123.html">ä»åˆ‡åœ†è§’å¼•å‘çš„å¯¹iOSåŠ¨ç”»æ¡†æ¶çš„æ¢ç©¶</a></li>
          
            <li><a title="åŸºäºAlamofireç½‘ç»œåº“çš„äºŒæ¬¡å°è£…" href="15017218903153.html">åŸºäºAlamofireç½‘ç»œåº“çš„äºŒæ¬¡å°è£…</a></li>
          
            <li><a title="Swiftä¸­å¯¹äºæœ‰å…ˆåé¡ºåºçš„ç½‘ç»œè¯·æ±‚çš„ä¼˜åŒ–" href="15008764200399.html">Swiftä¸­å¯¹äºæœ‰å…ˆåé¡ºåºçš„ç½‘ç»œè¯·æ±‚çš„ä¼˜åŒ–</a></li>
          
            <li><a title="Whats-new-in-swift-4 (ä¸‹)" href="14970555001135.html">Whats-new-in-swift-4 (ä¸‹)</a></li>
          
            <li><a title="Whats-new-in-swift-4 (ä¸Š)" href="14969065461458.html">Whats-new-in-swift-4 (ä¸Š)</a></li>
          
            <li><a title="Swiftä¸­å¯¹UserDefaultsçš„å°è£…" href="14956811508929.html">Swiftä¸­å¯¹UserDefaultsçš„å°è£…</a></li>
          
            <li><a title="Swiftçš„ä¸€ç§å¸¸ç”¨ç±»å‹" href="14936932217611.html">Swiftçš„ä¸€ç§å¸¸ç”¨ç±»å‹</a></li>
          
            <li><a title="æŒ‰é’®åŠ ä¸‹æ‹‰å¼¹æ¡†æ§ä»¶çš„å°è£…" href="14924176125873.html">æŒ‰é’®åŠ ä¸‹æ‹‰å¼¹æ¡†æ§ä»¶çš„å°è£…</a></li>
          

      
      </ul>
    </aside>

<a class="exit-off-canvas" href="#"></a>

        <section id="main-content" role="main" class="scroll-container">

          <div class="row">
            <div class="large-3 medium-3 columns">
              <div class="hide-for-small">
                <div class="sidebar">
                <nav>
                  <ul id="side-nav" class="side-nav">

                    
                      <li class="side-title"><span>Swift</span></li>
                        
                          <li><a title="æ²™æ¼åŠ¨ç”»" href="15367255656449.html">æ²™æ¼åŠ¨ç”»</a></li>
                        
                          <li><a title="å…³äºHTTPSçš„æ¢ç©¶" href="15221395300202.html">å…³äºHTTPSçš„æ¢ç©¶</a></li>
                        
                          <li><a title="çµæ´»æ‰©å±•çš„ä¸‹æ‹‰åˆ·æ–°æ§ä»¶çš„å°è£…" href="15113233292599.html">çµæ´»æ‰©å±•çš„ä¸‹æ‹‰åˆ·æ–°æ§ä»¶çš„å°è£…</a></li>
                        
                          <li><a title="å¯¹Swiftå†™æ—¶å¤åˆ¶æŠ€æœ¯çš„ç†è§£" href="15034498083541.html">å¯¹Swiftå†™æ—¶å¤åˆ¶æŠ€æœ¯çš„ç†è§£</a></li>
                        
                          <li><a title="ä»åˆ‡åœ†è§’å¼•å‘çš„å¯¹iOSåŠ¨ç”»æ¡†æ¶çš„æ¢ç©¶" href="15026719129123.html">ä»åˆ‡åœ†è§’å¼•å‘çš„å¯¹iOSåŠ¨ç”»æ¡†æ¶çš„æ¢ç©¶</a></li>
                        
                          <li><a title="åŸºäºAlamofireç½‘ç»œåº“çš„äºŒæ¬¡å°è£…" href="15017218903153.html">åŸºäºAlamofireç½‘ç»œåº“çš„äºŒæ¬¡å°è£…</a></li>
                        
                          <li><a title="Swiftä¸­å¯¹äºæœ‰å…ˆåé¡ºåºçš„ç½‘ç»œè¯·æ±‚çš„ä¼˜åŒ–" href="15008764200399.html">Swiftä¸­å¯¹äºæœ‰å…ˆåé¡ºåºçš„ç½‘ç»œè¯·æ±‚çš„ä¼˜åŒ–</a></li>
                        
                          <li><a title="Whats-new-in-swift-4 (ä¸‹)" href="14970555001135.html">Whats-new-in-swift-4 (ä¸‹)</a></li>
                        
                          <li><a title="Whats-new-in-swift-4 (ä¸Š)" href="14969065461458.html">Whats-new-in-swift-4 (ä¸Š)</a></li>
                        
                          <li><a title="Swiftä¸­å¯¹UserDefaultsçš„å°è£…" href="14956811508929.html">Swiftä¸­å¯¹UserDefaultsçš„å°è£…</a></li>
                        
                          <li><a title="Swiftçš„ä¸€ç§å¸¸ç”¨ç±»å‹" href="14936932217611.html">Swiftçš„ä¸€ç§å¸¸ç”¨ç±»å‹</a></li>
                        
                          <li><a title="æŒ‰é’®åŠ ä¸‹æ‹‰å¼¹æ¡†æ§ä»¶çš„å°è£…" href="14924176125873.html">æŒ‰é’®åŠ ä¸‹æ‹‰å¼¹æ¡†æ§ä»¶çš„å°è£…</a></li>
                        

                    
                  </ul>
                </nav>
                </div>
              </div>
            </div>
            <div class="large-9 medium-9 columns">

 


	
		<div class="markdown-body">
		<h1>æ²™æ¼åŠ¨ç”»</h1>

		<p>æœ€è¿‘æœ‰ä¸ªæ–°çš„éœ€æ±‚ï¼Œè¦åšä¸€ä¸ªæ²™æ¼åŠ¨ç”»ã€‚è¯´å®è¯å½“æˆ‘çœ‹åˆ°è®¾è®¡å¸ˆç»™æˆ‘çš„æ•ˆæœæ—¶å€™ï¼Œç¡®ç¡®å®å®éš¾åˆ°æˆ‘äº†ã€‚æˆ‘ä»¥å‰å¾ˆå°‘åšåŠ¨ç”»ç›¸å…³çš„ä¸œè¥¿ï¼Œæ¥è§¦çš„ä¹Ÿéƒ½æ¯”è¾ƒç®€å•ã€‚ä½†æ˜¯æˆ‘è¿˜æ˜¯æ¯”è¾ƒé«˜å…´çš„ï¼Œå› ä¸ºæˆ‘éå¸¸å–œæ¬¢è¿™ç§å…è´¹çš„å­¦ä¹ çš„æœºä¼šï¼Œæ¯å¤©éƒ½åšä¸€äº›ä¼šåšçš„ä¸œè¥¿å°±å¾ˆæ²¡åŠ²ã€‚åºŸè¯ä¸å¤šè¯´ï¼Œå¼€å§‹å§ã€‚</p>

<h4 id="toc_0">å…ˆçœ‹ä¸‹æ•ˆæœ</h4>

<p><img src="media/15367255656449/shdowClocktop5.gif" alt="shdowClocktop5"/></p>

<p>æˆ‘åˆšçœ‹åˆ°çš„æ—¶å€™ï¼Œå…¶å®æ˜¯æ— ä»ä¸‹æ‰‹çš„ï¼Œæ ¹æœ¬ä¸çŸ¥é“ä»å“ªé‡Œå¼€å§‹ï¼Œåæ¥ä¸€ä¸ªæœ‹å‹å’Œæˆ‘è¯´ï¼Œä½ åº”è¯¥æŠŠå®ƒåˆ†è§£å¼€ï¼Œä¸€èµ·çœ‹è‚¯å®šå¾ˆéº»çƒ¦ï¼Œæ¯”å¦‚å…ˆå®ç°æ²™æ¼é‡Œä¸ŠåŠéƒ¨åˆ†æ²™å †çš„åŠ¨ç”»ï¼Œåœ¨å®ç°ä¸‹åŠéƒ¨åˆ†ï¼Œåœ¨å®ç°æ²™å­çš„ï¼Œæœ€ååšæ—‹è½¬ã€‚ä¸€ç‚¹ç‚¹æ¥ã€‚è¿™ä¹ˆè¯´å®Œï¼Œæˆ‘è§‰å¾—è¿˜æ˜¯æ¯”è¾ƒå¥½çš„ï¼ŒæŠŠéš¾å¾—é—®é¢˜åˆ†è§£æˆä¸€ä¸ªä¸ªå°é—®é¢˜ï¼Œé€ä¸ªè§£å†³ï¼Œè€Œä¸”è¿™ä¹Ÿå¯ä»¥ä¿è¯æ¯ä¸ªå°æ¨¡å—ä¹‹é—´ç›¸äº’ä¸å½±å“ï¼Œä½ ä¸€ä¸ªé—®é¢˜è®¾è®¡çš„ä¸å¥½ï¼Œä¸ä¼šç‰µè¿å…¶ä»–çš„ï¼ŒåæœŸä¼˜åŒ–ä¹Ÿæ–¹ä¾¿ï¼Œæœ€åçš„åŠ¨ç”»æ˜¯ç”±è¿™äº›åŠ¨ç”»ç»„åˆä¸Šçš„ã€‚é‚£å¼€å§‹å§~</p>

<h4 id="toc_1">æ²™å †ä¸‹åŠéƒ¨åˆ†åŠ¨ç”»</h4>

<p>ç”±äºä¸Šä¸‹éƒ¨åˆ†å…¶å®æ˜¯ä¸€ä¸ªåŠ¨ç”»ï¼Œæ‰€ä»¥åªè¦å®ç°äº†ä¸€ä¸ªï¼Œå¦ä¸€ä¸ªä¹Ÿå°±å®Œæˆäº†ã€‚<br/>
<img src="media/15367255656449/15367262925821.jpg" alt="" style="width:608px;"/></p>

<p>å‡è®¾ç²‰è‰²éƒ¨åˆ†æ˜¯æ²™æ¼çš„åº•éƒ¨ï¼Œç°è‰²çš„æ˜¯æ²™å †ï¼Œé‚£è¿™ä¸ªåŠ¨ç”»åº”è¯¥æ˜¯ç°è‰²layerä»ç²‰è‰²layerçš„åº•éƒ¨ç§»åŠ¨åˆ°ä¸Šéƒ¨çš„è¿‡ç¨‹ï¼Œå› ä¸ºæˆ‘ä»¬è¿™ä¸ªæ˜¯ä¸è§„åˆ™çš„å›¾å½¢ï¼Œæ‰€ä»¥å¿…é¡»ä½¿ç”¨layerç”»å‡ºä¸€ä¸ªä¸è§„åˆ™çš„layerã€‚å…¶å®æˆ‘ä¸€å¼€å§‹çš„æƒ³æ³•å¾ˆç®€å•ï¼Œå°±æ˜¯ç”¨ä¸¤å¼ å›¾ç‰‡ï¼Œåšä½ç§»ï¼Œä½†å®é™…çš„æ•ˆæœæ˜¯ï¼š<br/>
<img src="media/15367255656449/15367263814233.jpg" alt="" style="width:516px;"/></p>

<p>å‘ä¸Šçš„åŠ¨ç”»è¿˜å¥½è¯´ï¼Œå‘ä¸‹çš„è¯ï¼Œæ²™å †ä¸‹é™çš„æ—¶å€™è¶…å‡ºå»çš„éƒ¨åˆ†ä¼šå±•ç¤ºå‡ºæ¥ï¼Œç›¸ä¿¡è¯´åˆ°è¿™å¤§å®¶ä¹Ÿå°±æ˜ç™½äº†ï¼Œè¿™ä¸ªä¸å¤šè§£é‡Šäº†ã€‚è‡³äºèƒŒæ™¯è‰²å¡«å……ï¼Œé®ç½©è¿™ç§çš„æ–¹æ¡ˆï¼Œå°±æ›´ä¸ç¬¦åˆéœ€æ±‚äº†ï¼Œä¸€ä¸ªæ²™æ¼è‚¯å®šæ˜¯é€æ˜çš„ï¼Œä½ åŠ ä¸Šåº•è‰²ï¼Œå¦‚æœä½ è¿™ä¸ªé¡µé¢çš„åº•è‰²å’Œä½ çš„è¿™ä¸ªåº•å±‚ä¸€æ ·è¿˜å¥½ï¼Œè¦ä¸ä¸€æ ·ï¼Œé‚£å¤šéš¾çœ‹ã€‚<br/>
æ‰€ä»¥ä¸€å®šè¦ç”¨layeræ¥åšã€‚</p>

<pre><code class="language-Swift">class SandBoxBottomLayer: CALayer {
    
    let sublayer1 = CAShapeLayer()
    
    init(frame : CGRect) {
        super.init()
        self.frame = frame
        self.configUI()
    }
    required init?(coder aDecoder: NSCoder) {
        fatalError(&quot;init(coder:) has not been implemented&quot;)
    }
    private func configUI() {
        let path = UIBezierPath()
        path.move(to: CGPoint(x: self.frame.width/2, y: 0))
        path.addLine(to: CGPoint(x: self.frame.width, y: self.frame.height*1/3))
        path.addLine(to: CGPoint(x: self.frame.width, y: self.frame.width))
        path.addLine(to: CGPoint(x: 0, y: self.frame.height))
        path.addLine(to: CGPoint(x: 0, y: self.frame.height*1/3))
        path.addLine(to: CGPoint(x: self.frame.width/2, y: 0))
        path.close()
        let sublayer = CAShapeLayer()
        sublayer.masksToBounds = true
        sublayer.frame = CGRect(x: 0, y: 0, width: self.frame.width, height: self.frame.height)
        sublayer.path = path.cgPath
        //æˆ‘è§‰å¾—åŠ èƒŒæ™¯è‰²åè€Œä¸æ˜¯å¾ˆå¥½çœ‹å‘¢
//        self.backgroundColor = UIColor(red: 232/255.0, green: 159/255.0, blue: 159/255.0, alpha: 1).cgColor
        self.mask = sublayer
        
        sublayer1.frame = CGRect(x: 0, y: self.frame.height, width: self.frame.width, height: self.frame.height)
        sublayer1.path = path.cgPath
        sublayer1.fillColor = UIColor(red: 206/255.0, green: 206/255.0, blue: 213/255.0, alpha: 1).cgColor
        
        
        self.addSublayer(sublayer1)
    }
}
</code></pre>

<p>è¿™é‡Œç”¨åˆ°äº†ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„å±æ€§å°±æ˜¯CALayerçš„maskï¼Œmaskå…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªCALayerï¼Œå®ƒå°±æ˜¯æ•´ä¸ªLayerçš„å¯è§†éƒ¨åˆ†ï¼Œæ‰€ä»¥å¤§å®¶åº”è¯¥çŸ¥é“ä¸ºä»€ä¹ˆViewåšåœ†è§’çš„æ—¶å€™éœ€è¦å¼€å¯masktoboundsäº†ã€‚CAShapeLayeræ˜¯CALayerçš„å­ç±»ï¼Œå®ƒå¯ä»¥å¡«å……é¢œè‰²ï¼Œè¿˜æœ‰pathè¿™ä¸ªå±æ€§ï¼Œå¯ä»¥ç”¨è´å¡å°”æ›²çº¿ç”»å‡ºä¸€ä¸ªå›¾å½¢ï¼Œåˆ›å»ºä¸€ä¸ªCAShapeLayerç„¶åè®¾ç½®å®ƒçš„pathç­‰äºæˆ‘ä»¬ç”»å¥½çš„æ²™å †çš„å›¾å½¢ï¼Œæœ€ååœ¨è®©CALayerçš„mask=CASHaperLayerï¼Œè¿™æ ·è¶…å‡ºçš„éƒ¨åˆ†å°±ä¸ä¼šçœ‹åˆ°äº†ã€‚ä¸€ä¸ªé€æ˜çš„ä¸è§„åˆ™çš„CALayerå°±ğŸ‘Œäº†ã€‚ç„¶ååœ¨ç”¨åˆšæ‰çš„pathåŒæ ·çš„æ–¹å¼åšä¸€ä¸ªæ²™å †layerï¼Œæ”¾åœ¨çˆ¶layerçš„åº•éƒ¨ã€‚<br/>
ä¸‹é¢å°±æ˜¯åŠ¨ç”»äº†ã€‚</p>

<pre><code class="language-Swift">func startAnimation() {
        sublayer1.removeAllAnimations()
        let animation = CAKeyframeAnimation(keyPath: &quot;position&quot;)
        animation.keyTimes = [NSNumber(value: 0.0),NSNumber(value: SandClockView.animationTimeWithOutRotate/SandClockView.animationTime),NSNumber(value: 1.0)]
        animation.values = [CGPoint(x: self.frame.width/2, y: self.frame.height*1.5),CGPoint(x: self.frame.width/2, y: self.frame.height/2),CGPoint(x: self.frame.width/2, y: self.frame.height/2)]
        animation.duration = SandClockView.animationTime
        animation.isRemovedOnCompletion = true
        animation.repeatCount = MAXFLOAT
        animation.timingFunctions = [CAMediaTimingFunction(controlPoints: 0.8, 0, 1, 1)]
        animation.fillMode = kCAFillModeForwards
        sublayer1.add(animation, forKey: &quot;&quot;)
    }
</code></pre>

<h5 id="toc_2">è·‘èµ·æ¥çš„æ•ˆæœæ˜¯</h5>

<p><img src="media/15367255656449/shdowClocktop.gif" alt="shdowClocktop"/></p>

<p>è¿™é‡Œå°±æ˜¯ä¸€ä¸ªå…³é”®å¸§åŠ¨ç”»ï¼Œè¯´ç™½äº†å°±æ˜¯ä¸€ä¸ªåˆ†æ—¶é—´æ®µæ§åˆ¶åŠ¨ç”»è¿›ç¨‹çš„ç±»ï¼Œä¹‹æ‰€ä»¥ç”¨å®ƒæ˜¯å› ä¸ºæˆ‘ä»¬è¦å’Œå…¶ä»–åŠ¨ç”»ä¸²è”èµ·æ¥ï¼Œä»æ²™æ¼å¼€å§‹åˆ°å…¨éƒ¨æ¼å®Œï¼Œç„¶åæ²™æ¼æ—‹è½¬ï¼Œè¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„åŠ¨ç”»ã€‚æ—¶é—´æ˜¯6.5ç§’ï¼Œå…¶ä¸­6ç§’æ˜¯æ²™æ¼çš„åŠ¨ç”»ï¼Œ0.5ç§’æ˜¯æ—‹è½¬çš„ã€‚æ‰€ä»¥å¤§å®¶çœ‹æˆ‘çš„keytimeå’Œvaluesçš„è®¾ç½®å°±æ˜ç™½ä»€ä¹ˆæ„æ€äº†ï¼Œåœ¨0-æ²™æ¼åŠ¨ç”»éƒ¨åˆ†å°±æŠŠä½ç§»åšå®Œï¼Œå‰©ä¸‹çš„æ—¶é—´ä½ç§»ä¸å˜ã€‚timingFunctionsè¿™ä¸ªå±æ€§å¯ä»¥æä¾›ä¸€ä¸ªè´å¡å°”æ›²çº¿æ§åˆ¶åŠ¨ç”»çš„éšç€æ—¶é—´å®Œæˆçš„é€Ÿåº¦ï¼Œç³»ç»Ÿæœ‰å‡ ä¸ªé¢„è®¾å¥½çš„ ï¼Œeaseinoutè¿™ç§çš„ã€‚ä¸è¿‡æˆ‘ä»¬çš„è®¾è®¡å¸ˆè§‰å¾—é‚£ç§æ•ˆæœä¸å¤ªæ»¡æ„ï¼Œæˆ‘å°±è‡ªå·±å†™äº†ä¸€ä¸ªã€‚ç®€å•è¯´ä¸‹è¿™ä¸ªå±æ€§ã€‚<br/>
<img src="media/15367255656449/10.1.jpeg" alt="10.1"/></p>

<p>CAMediaTimingFunctionè¿™ä¸ªç±»çš„åˆå§‹åŒ–æ–¹æ³•æ˜¯ä¼ ä¸¤ä¸ªç‚¹ã€‚æ²¡æœ‰è¿™ä¸¤ä¸ªç‚¹çš„æ—¶å€™ï¼ŒåŠ¨ç”»æ˜¯çº¿æ€§çš„ï¼Œæ–œç‡å›ºå®šã€‚ä½†æ˜¯å½“æˆ‘ä»¬åŠ å…¥ä¸¤ä¸ªæ§åˆ¶ç‚¹çš„æ—¶å€™ã€‚<br/>
<img src="media/15367255656449/10.2.jpeg" alt="10.2"/><br/>
æ–œç‡å°±å‘ç”Ÿå˜åŒ–äº†ï¼Œæ ¹æ®æ–œç‡æ¥å¼€ï¼ŒåŠ¨ç”»çš„é€Ÿåº¦æ˜¯å…ˆå¿«åæ…¢ï¼Œåœ¨å¿«çš„è¿‡ç¨‹ã€‚<br/>
æˆ‘ä¼ çš„ä¸¤ä¸ªç‚¹æ˜¯ï¼ˆ0.8ï¼Œ0ï¼‰ï¼Œï¼ˆ1ï¼Œ1ï¼‰äº†ï¼Œæ‰€ä»¥è¿™ä¸ªè´å°”èµ›æ›²çº¿çš„æ–œç‡ä¸€å®šæ˜¯åˆšå¼€å§‹å¾ˆæ…¢ï¼Œåæ¥é£™å‡è¿™ä¹ˆä¸€ä¸ªè¿‡ç¨‹ã€‚é‚£åŠ¨ç”»ä¹Ÿä¼šè¿™æ ·ï¼Œä¸€å¼€å§‹ä¸åŠ¨ï¼Œåæ¥è¶Šæ¥è¶Šå¿«ã€‚æˆ‘è§‰å¾—è®¾è®¡å¸ˆè¿™ä¹ˆåšå¾ˆåˆç†ï¼Œè¿™äº‹ä¸€ä¸ªloadingå›¾ï¼Œå…ˆå¿«åé¢çš„ä½“éªŒæ˜¯å¾ˆå¥½çš„ï¼Œç›¸ä¿¡å¤§å®¶éƒ½ä½“éªŒè¿‡åŠ è½½ç½‘é¡µæ—¶å€™é‚£ä¸ªloadingæ¡çº¿å¿«åæ…¢çš„æ„Ÿè§‰å§ã€‚<br/>
è¿™ä¸ªè¯´å®Œäº†é‚£ä¸Šéƒ¨åˆ†çš„ä¹Ÿä¸€æ ·å°±è¯´å®Œäº†ã€‚</p>

<h4 id="toc_3">æ²™å­åŠ¨ç”»</h4>

<p>æ²™ç²’çš„åŠ¨ç”»åœ¨è®¾è®¡å¸ˆç»™æˆ‘çš„è®¾è®¡ç¨¿ä¸­å·²ç»ç»™å‡ºäº†æ²™ç²’çš„ä¸ªæ•°ï¼Œæ¯ä¸ªæ²™ç²’çš„å¼€å§‹ä¸‹è½çš„åæ ‡å’Œé€Ÿåº¦ï¼Œæ‰€ä»¥è¿™ä¸ªç›¸å¯¹å¥½åšã€‚æˆ‘æŠŠä»£ç è´´å‡ºæ¥çœ‹ä¸‹å°±å¥½ã€‚</p>

<pre><code class="language-Swift">class SandLayer: CALayer {
    //ç¬¬ä¸€ç»„æ²™ç²’
    let sand05Layer = CALayer()
    let sand05Layer1 = CALayer()
    //ç¬¬äºŒç»„æ²™ç²’
    let sand03Layer = CALayer()
    let sand03Layer1 = CALayer()
    //ç¬¬ä¸‰ç»„æ²™ç²’
    let sand01Layer = CALayer()
    let sand01Layer1 = CALayer()
    init(frame: CGRect) {
        super.init()
        self.frame = frame
        self.configUI()
    }
    
    required init?(coder aDecoder: NSCoder) {
        fatalError(&quot;init(coder:) has not been implemented&quot;)
    }
    private func configUI() {
        sand05Layer.frame = CGRect(x: 0, y: -3, width: 1, height: 1)
        sand05Layer.backgroundColor = UIColor(red: 206/255.0, green: 206/255.0, blue: 213/255.0, alpha: 1).cgColor
        self.addSublayer(sand05Layer)
        sand05Layer1.frame = CGRect(x: 1, y: -10, width: 1, height: 2)
        sand05Layer1.backgroundColor = UIColor(red: 206/255.0, green: 206/255.0, blue: 213/255.0, alpha: 1).cgColor
        self.addSublayer(sand05Layer1)
        
        sand03Layer.frame = CGRect(x: 0, y: -10, width: 1, height: 2)
        sand03Layer.backgroundColor = UIColor(red: 206/255.0, green: 206/255.0, blue: 213/255.0, alpha: 1).cgColor
        self.addSublayer(sand03Layer)
        sand03Layer1.frame = CGRect(x: 1, y: -3, width: 1, height: 1)
        sand03Layer1.backgroundColor = UIColor(red: 206/255.0, green: 206/255.0, blue: 213/255.0, alpha: 1).cgColor
        self.addSublayer(sand03Layer1)
//
        sand01Layer.frame = CGRect(x: 0, y: -3, width: 1, height: 1)
        sand01Layer.backgroundColor = UIColor(red: 206/255.0, green: 206/255.0, blue: 213/255.0, alpha: 1).cgColor
        self.addSublayer(sand01Layer)
        sand01Layer1.frame = CGRect(x: 1, y: -10, width: 1, height: 2)
        sand01Layer1.backgroundColor = UIColor(red: 206/255.0, green: 206/255.0, blue: 213/255.0, alpha: 1).cgColor
        self.addSublayer(sand01Layer1)
    }
    func startAnimation() {
        self.addAnimation(withDuration: SandClockView.sandAnimationTime05, layer: sand05Layer)
        self.addAnimation(withDuration: SandClockView.sandAnimationTime05, layer: sand05Layer1)
        self.addAnimation(withDuration: SandClockView.sandAnimationTime03, layer: sand03Layer)
        self.addAnimation(withDuration: SandClockView.sandAnimationTime03, layer: sand03Layer1)
        self.addAnimation(withDuration: SandClockView.sandAnimationTime01, layer: sand01Layer)
        self.addAnimation(withDuration: SandClockView.sandAnimationTime01, layer: sand01Layer1)
    }
    private func addAnimation(withDuration duration: CFTimeInterval,layer: CALayer){
        layer.removeAllAnimations()
        let animation = CABasicAnimation(keyPath: &quot;position&quot;)
        animation.fromValue = layer.position
        animation.toValue = CGPoint(x: layer.position.x, y: self.frame.height)
        animation.duration = duration
        animation.isRemovedOnCompletion = true
        animation.repeatCount = MAXFLOAT
        animation.valueFunction = CAValueFunction(name: kCAMediaTimingFunctionLinear)
        animation.fillMode = kCAFillModeForwards
        layer.add(animation, forKey: nil)
    }
}
</code></pre>

<p>6ä¸ªæ²™ç²’çš„ä½ç§»åŠ¨ç”»è€Œå·²ã€‚<br/>
<img src="media/15367255656449/shdowClocktop1.gif" alt="shdowClocktop1"/></p>

<h4 id="toc_4">ç»„åˆ+æ—‹è½¬åŠ¨ç”»</h4>

<pre><code class="language-Swift">class SandClockView: UIView {
    static let animationTime = 6.5                  //æ²™æ¼æ»´å®Œ+æ—‹è½¬çš„æ—¶é—´
    static let animationTimeWithOutRotate = 6.1     //æ²™æ¼æ»´å®Œçš„æ—¶é—´
    static let sandAnimationTime05 = 0.5            //æ²™å­ä¸‹å æ—¶é—´ å…±3ä¸­
    static let sandAnimationTime03 = 0.3
    static let sandAnimationTime01 = 0.1
    let boxWidth: CGFloat = 34
    let boxHeight: CGFloat = 25
    lazy var topLayer: SandBoxTopLayer = {
        let layer = SandBoxTopLayer(frame: CGRect(x: 7, y: 3, width: boxWidth , height: boxHeight))
        return layer
    }()
    lazy var bottomLayer: SandBoxBottomLayer = {
        let layer = SandBoxBottomLayer(frame: CGRect(x: 7, y: self.frame.height/2-1, width: boxWidth, height: boxHeight))
        return layer
    }()
    lazy var sandLayer: SandLayer = {
        let layer = SandLayer(frame: CGRect(x: self.frame.width/2-1, y: self.frame.height/2, width: 2, height: 25))
        return layer
    }()
    override init(frame: CGRect) {
        super.init(frame: frame)
        self.configUI()
    }
    required init?(coder aDecoder: NSCoder) {
        fatalError(&quot;init(coder:) has not been implemented&quot;)
    }
    private func configUI() {
        self.layer.addSublayer(bottomLayer)
        self.layer.addSublayer(sandLayer)
        self.layer.addSublayer(topLayer)
        let imageView = UIImageView(image: UIImage(named: &quot;sandclock_bg&quot;))
        imageView.frame = self.bounds
        self.addSubview(imageView)
    }
    
}
</code></pre>

<p>åœ¨ä¸€ä¸ªViewä¸ŠæŠŠè¿™äº›åŠ¨ç”»ç»„åˆä¸Š,åœ¨åŠ ä¸Šä¸€ä¸ªæ²™æ¼çš„èƒŒæ™¯æ¡†ï¼Œå°±å¯ä»¥å¼€å§‹åŠ¨ç”»äº†ï¼Œå¦‚æœä½ ä¸å–œæ¬¢ç”¨UIImageViewçš„è¯è¿™ä¸ªæ²™æ¼è‡ªå·±ç”¨è´å¡å°”æ›²çº¿ç”»å‡ºæ¥ä¹Ÿä¸éš¾ã€‚</p>

<pre><code class="language-Swift">func startAnimation(){
        topLayer.startAnimation()
        bottomLayer.startAnimation()
        sandLayer.startAnimation()
        self.layer.removeAllAnimations()
        let animation = CAKeyframeAnimation(keyPath: &quot;transform.rotation.z&quot;)
        animation.keyTimes = [NSNumber(value: 0.0),NSNumber(value: SandClockView.animationTimeWithOutRotate/SandClockView.animationTime),NSNumber(value:0.97),NSNumber(value: 1.0)]
        animation.values = [0,0,Double.pi+0.07,Double.pi]
        animation.duration = SandClockView.animationTime
        animation.isRemovedOnCompletion = true
        animation.repeatCount = MAXFLOAT
        animation.timingFunctions = [CAMediaTimingFunction(name: kCAMediaTimingFunctionEaseOut),
                                     CAMediaTimingFunction(name: kCAMediaTimingFunctionEaseOut),
                                     CAMediaTimingFunction(name: kCAMediaTimingFunctionEaseOut),
                                     CAMediaTimingFunction(name: kCAMediaTimingFunctionEaseIn)]
        animation.fillMode = kCAFillModeForwards
        self.layer.add(animation, forKey: &quot;&quot;)
    }
</code></pre>

<p>å¼€å§‹åŠ¨ç”»ä¸­è°ƒç”¨æ‰€æœ‰ç»„ä»¶åŒ–çš„åŠ¨ç”»å¼€å§‹ï¼Œå¹¶ä¸”åŠ ä¸Šå½“å‰Viewæ—‹è½¬åŠ¨ç”»ã€‚åŒæ ·æ—¶é—´è¦é…åˆä¸Šã€‚<br/>
æˆ‘è¿™ä¸ªæ—‹è½¬åŠ¨ç”»æœ¬æ¥äº«ç”¨springanimationæ¥åšï¼Œä½†æ˜¯æ²¡æ‰¾åˆ°è‡ªèº«æ—‹è½¬çš„APIï¼Œæ‰€ä»¥åªèƒ½å…ˆç”¨è¿™ç§æ–¹å¼æ¥å®ç°äº†ã€‚ä¸è¿‡æ•ˆæœä¹Ÿè¿˜ä¸é”™ï¼Œgifå¯èƒ½çœ‹ç€æœ‰ç‚¹å¡ï¼Œå®é™…çš„æ•ˆæœå¥½å¾ˆå¤šã€‚æ¯ä¸ªåŠ¨ç”»ä½†çœ‹èµ·æ¥éƒ½å¾ˆç®€å•ï¼Œå¾ˆä¹Ÿå¾ˆéš¾çœ‹ï¼Œä½†æ˜¯ç»„åˆèµ·æ¥ï¼Œæ•ˆæœå°±å¾ˆä¸é”™äº†ã€‚<br/>
<img src="media/15367255656449/shdowClocktopB.gif" alt="shdowClocktopB"/><br/>
è¿™æ˜¯æœ€ç»ˆçš„æ•ˆæœã€‚å¯¹æ¯”äº†ä¸€ä¸‹å’Œè®¾è®¡å¸ˆç»™æˆ‘çš„æ•ˆæœå¯ä»¥è¾¾åˆ°95%ç›¸ä¼¼ï¼Œæœ‰äº›åœ°æ–¹çš„æ›²çº¿ï¼ŒåŠ é€Ÿåº¦ï¼Œæ—¶é—´ï¼Œä»–æ˜¯ç›´æ¥ç”¨çš„fackbookçš„é‚£å¥—çš„å‡†åˆ™çš„ï¼Œç»™ä¸å‡ºæˆ‘å…·ä½“çš„æ•°å€¼ï¼Œæ‰€ä»¥è¿˜æ˜¯æœ‰äº›åå·®ã€‚ä¸è¿‡ä»–è§‰å¾—å·²ç»å¯ä»¥æ¥å—äº†ã€‚ä½†æ˜¯è¾¾åˆ°100%æ‰æ˜¯æˆ‘ä»¬ç¨‹åºå‘˜åº”è¯¥åŠªåŠ›çš„æ–¹å‘ã€‚</p>

<h4 id="toc_5">æ€»ç»“</h4>

<p>è¿™æ¬¡ç®—æ˜¯å¯¹ä»¥å‰ç”¨çš„åŠ¨ç”»çš„ä¸€æ¬¡å¤ä¹ ï¼ŒåŸºæœ¬æŠŠå¾ˆå¤šåŠ¨ç”»éƒ½ç”¨äº†ä¸€éã€‚ä»æ— ä»ä¸‹æ‰‹åˆ°å®Œæˆå…¶å®ä¹Ÿå°±æ˜¯ä¸€å¤©åŠçš„æ—¶é—´ã€‚æ‰€ä»¥è¿™ç§æŠŠå¤§é—®é¢˜æ‹†åˆ†æˆå°é—®é¢˜ï¼Œè¿½ä¸ªè§£å†³çš„æ€æƒ³è¿˜æ˜¯å¾ˆå¥½ç”¨çš„ã€‚<br/>
æœ€å æºç åœ°å€ <a href="https://github.com/RookieNeo/NeoSandClock">https://github.com/RookieNeo/NeoSandClock</a><br/>
æ”¯æŒPod</p>

<p>å‚è€ƒèµ„æ–™ï¼š<br/>
<a href="https://zsisme.gitbooks.io/ios-/content/chapter10/custom-easing-functions.html">iOSæ ¸å¿ƒåŠ¨ç”»</a></p>


		</div>
	

 
	

  
  
</div></div>


<div class="page-bottom">
  <div class="row">
  <hr />
  <div class="small-9 columns">
  <p class="copyright">Copyright &copy; 2015
Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp; 
Theme used <a target="_blank" href="http://github.com">GitHub CSS</a>.</p>
  </div>
  <div class="small-3 columns">
  <p class="copyright text-right"><a href="#header">TOP</a></p>
  </div>
   
  </div>
</div>

        </section>
      </div>
    </div>
    
    
    <script src="asset/js/foundation.min.js"></script>
    <script src="asset/js/foundation/foundation.offcanvas.js"></script>
    <script>
      $(document).foundation();

     
    </script>
    


  </body>
</html>
